% quick script to check the variance across each regional hypothesis' pair
% amounts

%% params

load('/export/home/mike/matlab/origin/coords/61chans_ns.mat')
type = 'regional';
regions = {'frontal','central','parietal','occipital','lefttemporal','righttemporal'};
min_dist = 5;
maxpairs2test = 12:46;
minpairs2test = 7;

%% generate initial pair set

if strcmpi(type,'combo') % combinatorial start point
    
    p = nchoosek(1:61,2);
    pi = 1:length(p);
    
elseif strcmpi(type,'regional') % regional start point

    [p,pi,pi_lbl] = determine_regional_pairs(chan_locs, 'both', regions, true);

end

%% filter by distance and angle, remove tiny groups

[p2,pi2]=pair_filter(p,pi,chan_locs,'distance',[min_dist Inf]);
[p3,pi3]=pair_filter(p2,pi2,chan_locs,'angle','aplr');

n_hyps = max(pi3);
p4=[]; pi4=[]; pi_lbl2=cell(1,1); hd=0;
for hyp=1:n_hyps
    if sum(pi3==hyp) >= minpairs2test
        hd=hd+1;
        p4 = [p4; p3(pi3==hyp,:)];
        pi4 = [pi4; hd*ones(size(pi3(pi3==hyp)))];
        pi_lbl2{hd} = pi_lbl{hyp};
    end
end

%% test max pair amounts

n_hyps = max(pi4);
n_mpvals = length(maxpairs2test);
sp_dims = numSubplots(n_mpvals);
figure;
spd=0;
for pair_thresh = maxpairs2test
    spd=spd+1;
    subplot(sp_dims(1), sp_dims(2), spd);
    
    [p5,pi5] = sparsify_regional_hyps( p4, pi4, chan_locs, pair_thresh);
    
    [co(pair_thresh),ce(pair_thresh)] = hist(pi5,n_hyps);
    pairvar = var(co(pair_thresh));
    
    bar(ce(pair_thresh),co(pair_thresh));
    axis([0 n_hyps 0 maxpairs2test(end)]);
    title(['MPPH=',num2str(pair_thresh),', var=',num2str(pairvar,3)])
    
end